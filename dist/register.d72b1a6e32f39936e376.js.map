{"version":3,"file":"register.d72b1a6e32f39936e376.js","mappings":"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","sources":["webpack://book-site/./src/js/register.js"],"sourcesContent":["\n\n\nconst registerForm = document.querySelector('#register--form')\nconst registerLogin = document.querySelector('#login')\nconst registerPassword = document.querySelector('#password')\nconst repeatPassword = document.querySelector('#repeat-password')\nconst registerUsername = document.querySelector('#username')\nconst warning = document.querySelector('.registerForm__warning')\nconst registerAge = document.querySelector('#age')\nconst character = /^[a-zA-Z0-9_-]{3,21}$/;\n\nlet person = {}\n\nregisterForm.addEventListener(\"submit\", (e) => {\n    e.preventDefault()\n    checkFields()\n    if (person.username && person.password && person.repeatPassword && person.firstName && person.age) {\n        registerValidate(person)\n    }\n})\n\n\nfunction checkFields() {\n    const loginValue = registerLogin.value.trim()\n    const passwordValue = registerPassword.value.trim()\n    const repeatPassValue = repeatPassword.value.trim()\n    const userNameValue = registerUsername.value.trim()\n    const ageValue = registerAge.value.trim()\n\n    if (character.test(loginValue) !== true) {\n        setError(registerLogin, 'error--send')\n    } else {\n        setSuccess(registerLogin, 'error--send')\n    }\n\n    if (character.test(userNameValue) !== true) {\n        setError(registerUsername, 'error--send')\n    } else {\n        setSuccess(registerUsername, 'error--send')\n    }\n\n    if (ageValue === '') {\n        setError(registerAge, 'error--send')\n    } else {\n        setSuccess(registerAge, 'error--send')\n    }\n\n    if (character.test(passwordValue) !== true) {\n        setError(registerPassword, 'error--send')\n    } else {\n        setSuccess(registerPassword, 'error--send')\n    }\n    if (character.test(repeatPassValue) !== true) {\n        setError(repeatPassword, '')\n    } else if (passwordValue !== repeatPassValue) {\n        setError(repeatPassword, 'error-repeated')\n    } else {\n        setSuccess(repeatPassword, 'error-repeated')\n    }\n\n\n}\n\nfunction setError(login, message) {\n    const errorSpan = login.parentElement.querySelector('.registerForm__error-message')\n    errorSpan.classList.add(message)\n    login.classList.add('input-error')\n}\n\nfunction setSuccess(login, message) {\n    const errorSpan = login.parentElement.querySelector('.registerForm__error-message')\n    errorSpan.classList.remove(message)\n    login.classList.remove('input-error')\n    person = {...person, [login.name]: login.value}\n}\n\nconst registerValidate = async () => {\n\n    try {\n        const responseData = await fetch(\"http://localhost:1717/signin\", {\n            method: \"POST\",\n\n            body: JSON.stringify(person),\n            headers: {\n                \"Content-type\": \"application/json; charset=UTF-8\"\n            }\n        });\n        if (responseData.ok === false) {\n            console.log(404)\n        } else {\n            setTimeout(() => {\n                location.assign(\"/books.html\")\n            }, 500)\n        }\n\n        const newUser = await responseData.json()\n        if (newUser === 'user with this username already exists'){\n            warning.classList.add('warning')\n        }else{\n            warning.classList.remove('warning')\n            const personalUser = newUser.data\n            const personalToken = newUser.token\n\n            localStorage.setItem(\"user\", personalUser.username)\n            localStorage.setItem(\"token\", personalToken)\n        }\n\n    } catch (error) {\n        console.log(\"Couldn't fetch\", error.message)\n    }\n}"],"names":["registerForm","document","querySelector","registerLogin","registerPassword","repeatPassword","registerUsername","warning","registerAge","character","person","addEventListener","e","preventDefault","checkFields","username","password","firstName","age","registerValidate","loginValue","value","trim","passwordValue","repeatPassValue","userNameValue","ageValue","test","setError","setSuccess","login","message","errorSpan","parentElement","classList","add","remove","name","responseData","fetch","method","body","JSON","stringify","headers","ok","console","log","setTimeout","location","assign","newUser","json","personalUser","data","personalToken","token","localStorage","setItem","error"],"sourceRoot":""}